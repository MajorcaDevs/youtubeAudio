(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{137:function(e,t,a){},141:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),o=a(21),r=a.n(o),s=a(28),l=a(13),c=a(7),u=a(9),d=a.n(u),h=a(15),m=a(8),g=a(10),b=a(20),p=a(18),f=a(19),y=a(1),v=a(12),w=a.n(v),k=a(5),E=a(16),S=a(62),j=a.n(S),O=(a(89),a(91),a(93),a(63)),P=a.n(O),x=a(69),T=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:void 0;if(Object(m.a)(this,e),t)this._array=t,this._store();else{var a=this._obtain();null!==a?(this._array=a.filter(function(e){return null!==e.title}),this._store()):(this._array=[],this._store())}}return Object(g.a)(e,[{key:"add",value:function(){for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return new e(Object(c.a)(this.values).concat(a))}},{key:"addFirst",value:function(t){return new e([t].concat(Object(c.a)(this.values)))}},{key:"emptyQueue",value:function(){return new e([])}},{key:"deleteFirst",value:function(){return this.values.length>0?new e(this.values.slice(1)):this}},{key:"delete",value:function(t){var a=this.values.findIndex(function(e){return t.id===e.id});return-1!==a?new e(this.values.slice(0,a).concat(this.values.slice(a+1))):this}},{key:"reorder",value:function(t,a){var n=Array.from(this._array),i=n.splice(t+1,1),o=Object(x.a)(i,1)[0];return n.splice(a+1,0,o),new e(n)}},{key:"_store",value:function(){try{window.sessionStorage.setItem("playQueue",JSON.stringify(this._array))}catch(e){}}},{key:"_obtain",value:function(){var e=window.sessionStorage.getItem("playQueue");return e?JSON.parse(e):e}},{key:"values",get:function(){return this._array}}]),e}(),N=a(32),R=(a(96),function(e){var t=e.song,a=e.index,n=e.onRemove;return i.a.createElement(N.b,{key:"".concat(a,"-").concat(t.id),draggableId:"".concat(a,"-").concat(t.id),index:a},function(e,o){return i.a.createElement("div",Object.assign({ref:e.innerRef},e.draggableProps,e.dragHandleProps,{className:"row",style:Object(l.a)({},e.draggableProps.style,{color:o.isDragging?"#AAA":null})}),i.a.createElement("div",{className:"col-auto reorder-icon"},i.a.createElement("i",{className:"material-icons"},"reorder")),i.a.createElement("div",{className:"col"},t.title),i.a.createElement("div",{className:"col-auto delete-icon"},i.a.createElement("button",{className:"btn btn-sm",onClick:function(){return n(t,a)}},i.a.createElement("i",{className:"material-icons"},"delete"))))})}),_=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(b.a)(this,Object(p.a)(t).call(this,e))).state={edit:!1},a.changeEditMode=a.changeEditMode.bind(Object(y.a)(Object(y.a)(a))),a.reordered=a.reordered.bind(Object(y.a)(Object(y.a)(a))),a}return Object(f.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,a=this.props,n=a.showing,o=a.playQueue,r=this.state.edit,s=[];return n&&(o.values.length<=1?s.push(function(e){return i.a.createElement("div",{id:"playQueueList",style:e}," Play Queue is Empty ")}):s.push(function(t){return i.a.createElement("div",{id:"playQueueList",style:Object(l.a)({overflowY:"scroll"},t)},i.a.createElement("div",null,i.a.createElement("h2",null,"Play Queue"),i.a.createElement("div",{className:"col-auto edit-icon"},i.a.createElement("button",{className:"btn btn-sm edit-button ".concat(r?"active":""),onClick:e.changeEditMode},i.a.createElement("i",{className:"material-icons"},"edit")))),r?i.a.createElement(N.a,{onDragEnd:e.reordered},i.a.createElement(N.c,{droppableId:"play-queue-list"},function(t){return i.a.createElement("div",{className:"list-container",ref:t.innerRef},Object(c.a)(e.props.playQueue.values).splice(1).map(function(t,a){return i.a.createElement(R,{key:a,song:t,index:a,onRemove:e.props.onPlaylistItemRemove})}),i.a.createElement("hr",null))})):i.a.createElement("div",{className:"list-container"},Object(c.a)(e.props.playQueue.values).splice(1).map(function(e,t){return i.a.createElement("div",{className:"row",key:t},i.a.createElement("div",{className:"col"},e.title))}),i.a.createElement("hr",null)))})),i.a.createElement(E.b,{keys:s.map(function(){return"queue"}),from:{right:t._right},enter:{right:0},leave:{right:t._right}},s)}},{key:"changeEditMode",value:function(e){e.preventDefault(),this.setState({edit:!this.state.edit})}},{key:"reordered",value:function(e){e.destination&&this.props.onPlaylistItemReorder(e.source.index,e.destination.index)}}],[{key:"_right",get:function(){var e=window.document.body.clientWidth;return e<576?.9*-e:e<768?-288:e<1200?-384:-400}}]),t}(n.Component),I="AIzaSyAhqRo4TayeA-BgAqmKOHjk7MnrAz-HcBo",C="https://ytdl-audio-api.majorcadevs.com/api",Q=function(){var e=document.createElement("audio");return{opus:""!==e.canPlayType("audio/webm; codecs=opus"),vorbis:""!==e.canPlayType("audio/webm; codecs=vorbis"),m4a:""!==e.canPlayType("audio/x-m4a; codecs=mp4a.40.2")}}(),M=function e(t,a){Object(m.a)(this,e),this.message=t,this.descriptiveMessage=a},D=function(e){return new Promise(function(t,a){w.a.ajax({async:!0,type:"GET",url:"".concat(C,"/").concat(e,"/formats"),success:function(e){var n,i;0!==(e=e.filter(function(e){return Q.m4a&&"m4a"===e.container}).concat(e.filter(function(e){return Q.vorbis&&e.extra.startsWith("vorbis")})).concat(e.filter(function(e){return Q.opus&&e.extra.startsWith("opus")}))).length?(e.forEach(function(e){var t=e.extra.split(/[\s@k]+/g);e.codec=t[0],e.bitrate=parseInt(t[1],10),"vorbis"!==e.codec&&"opus"!==e.codec&&(e.codec="m4a")}),e.sort((n="bps",i=!0,function(e,t){return e[n]>t[n]?i?-1:1:e[n]<t[n]?i?1:-1:0})),t(e[0])):a(new M("No compatible sources for your browser","We could not find any compatible sources for your browser. It seems that your browser doesn't support neither Opus, Vorbis nor AAC."))},error:function(){return a(new M("Video not found","Check that the video URL exists or is complete."))}})})},L=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(a,n){w.a.ajax({async:!0,type:"GET",url:t?"".concat(C,"/").concat(e,"/").concat(t):"".concat(C,"/").concat(e),success:function(e){a(e)},error:function(){return n(new M("Video not found","Check that the video URL exists or is complete."))}})})},A=function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new Promise(function(n,i){var o="https://www.googleapis.com/youtube/v3/playlistItems?part=id,snippet&maxResults=50&playlistId=".concat(t,"&key=").concat(I);a&&(o+="&pageToken=".concat(a)),w.a.ajax({url:o,async:!0,type:"GET",success:function(a){var o=a.items.map(function(e){return{id:e.snippet.resourceId.videoId,title:e.snippet.title}});a.nextPageToken?e(t,a.nextPageToken).then(function(e){return n(Object(c.a)(o).concat(Object(c.a)(e)))}).catch(i):n(o)},error:function(){return i(new M("Cannot load videos from playlist","Something bad has happened while we were asking to YouTube for the videos in that playlist :("))}})})},U=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return new(function(){function a(){Object(m.a)(this,a),this.url="https://www.googleapis.com/youtube/v3/search?part=snippet&q=".concat(encodeURIComponent(e),"&key=").concat(I,"&maxResults=").concat(Math.min(t,50),"&type=video,playlist"),this.nextPageToken=null,this.totalListed=0,this.total=NaN}return Object(g.a)(a,[{key:"getNextPage",value:function(){var e=this;return this.hasEnded?Promise.reject(new Error("End of the list")):new Promise(function(t,a){var n=e.url;e.nextPageToken&&(n+="&pageToken=".concat(e.nextPageToken)),w.a.ajax({url:n,async:!0,type:"GET",success:function(a){a.nextPageToken&&(e.nextPageToken=a.nextPageToken),e.totalListed+=a.items.length,e.total=a.pageInfo.totalResults,t(a.items)},error:function(){return a(new M("Cannot search for videos","Something bad has happened while we were asking to YouTube for videos :("))}})})}},{key:"hasEnded",get:function(){return this.totalListed===this.total}},{key:"loadedPages",get:function(){return Math.ceil(this.totalListed/t)}},{key:"totalPages",get:function(){return Math.ceil(this.total/t)}}]),a}())},F=(a(137),function(e){var t=e.page,a=e.totalPages,n=e.prevPage,o=e.nextPage;return i.a.createElement("div",{className:"btn-group search-panel-pagination",role:"group","aria-label":"Pagination"},i.a.createElement("button",{type:"button",className:"btn btn-secondary btn-sm",disabled:0===t,onClick:n},i.a.createElement("i",{className:"material-icons"},"chevron_left")),i.a.createElement("button",{type:"button",className:"btn btn-secondary btn-sm",disabled:!0},t+1),i.a.createElement("button",{type:"button",className:"btn btn-secondary btn-sm",disabled:t===a-1,onClick:o},i.a.createElement("i",{className:"material-icons"},"chevron_right")))}),V=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(b.a)(this,Object(p.a)(t).call(this,e))).state={text:"",loading:!1,results:[],page:0},a.searchFieldDoSearch=a.searchFieldDoSearch.bind(Object(y.a)(Object(y.a)(a))),a.searchFieldChanged=a.searchFieldChanged.bind(Object(y.a)(Object(y.a)(a))),a.prevPage=a.prevPage.bind(Object(y.a)(Object(y.a)(a))),a.nextPage=a.nextPage.bind(Object(y.a)(Object(y.a)(a))),a}return Object(f.a)(t,e),Object(g.a)(t,[{key:"render",value:function(){var e=this,a=this.props,n=a.showing,o=a.onPlayClicked,r=a.onEnqueueClicked,s=this.state,l=s.text,c=s.loading,u=s.results,d=s.page,h=[];return n&&h.push(function(t){return i.a.createElement("div",{id:"searchPanel",style:t},i.a.createElement("div",{className:"mt-4 ml-4 mr-4"},i.a.createElement("div",{className:"form-group"},i.a.createElement("label",{htmlFor:"search-input"},"Search for videos"),i.a.createElement("input",{id:"search-input",className:"form-control",placeholder:"Search",disabled:c,value:l,onKeyUp:e.searchFieldDoSearch,onChange:e.searchFieldChanged})),i.a.createElement("div",{className:"container"},u.length>0?i.a.createElement(F,{page:d,nextPage:e.nextPage,prevPage:e.prevPage,totalPages:e._search.totalPages-1}):null,u.length>0?u[d].map(function(e,t){return i.a.createElement("div",{key:t,className:"row mb-1 result"},i.a.createElement("div",{className:"col-auto"},e.snippet.thumbnails&&i.a.createElement("img",{src:(e.snippet.thumbnails.medium||e.snippet.thumbnails.default).url,alt:"Video thumbnail",width:128,onClick:function(){return o(e)}})),i.a.createElement("div",{className:"col row"},i.a.createElement("div",{className:"col-12 align-self-start"},i.a.createElement("small",null,e.snippet.title)),i.a.createElement("div",{className:"col-12 align-self-end"},i.a.createElement("a",{href:"#",onClick:function(t){t.preventDefault(),o(e)}},i.a.createElement("i",{className:"material-icons"},"play_circle_outline")),i.a.createElement("a",{href:"#",onClick:function(t){t.preventDefault(),r(e)}},i.a.createElement("i",{className:"material-icons"},"playlist_add")))))}):null,u.length>0?i.a.createElement(F,{page:d,nextPage:e.nextPage,prevPage:e.prevPage,totalPages:e._search.totalPages-1}):null)))}),i.a.createElement(E.b,{keys:h.map(function(){return"queue"}),from:{right:t._right},enter:{right:0},leave:{right:t._right}},h)}},{key:"searchFieldChanged",value:function(e){e.preventDefault(),this.setState({text:e.target.value})}},{key:"searchFieldDoSearch",value:function(){var e=Object(h.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(13!==t.keyCode){e.next=11;break}return t.preventDefault(),this.setState({loading:!0,page:0,results:[]}),this._search=U(this.state.text),e.t0=this,e.next=7,this._search.getNextPage();case 7:e.t1=e.sent,e.t2=[e.t1],e.t3={loading:!1,results:e.t2},e.t0.setState.call(e.t0,e.t3);case 11:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"prevPage",value:function(e){e.preventDefault(),this.setState({page:Math.max(this.state.page-1,0)})}},{key:"nextPage",value:function(){var e=Object(h.a)(d.a.mark(function e(t){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),this.state.page+1!==this._search.loadedPages){e.next=15;break}return this.setState({loading:!0}),e.t0=this,e.t1=Object(c.a)(this.state.results),e.next=7,this._search.getNextPage();case 7:e.t2=e.sent,e.t3=[e.t2],e.t4=e.t1.concat.call(e.t1,e.t3),e.t5=this.state.page+1,e.t6={loading:!1,results:e.t4,page:e.t5},e.t0.setState.call(e.t0,e.t6),e.next=16;break;case 15:this.setState({page:Math.min(this.state.page+1,this._search.totalPages-1)});case 16:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()}],[{key:"_right",get:function(){var e=window.document.body.clientWidth;return e<576?.9*-e:e<768?-288:e<1200?-384:-400}}]),t}(n.Component),q=a(68),Y=a.n(q);Map.prototype.map=function(e){var t=[];return this.forEach(function(a,n){return t.push(e(a,n))}),t},Map.prototype.sort=function(e){return new Map(Object(c.a)(this.entries()).sort(function(t,a){return e({key:t[0],value:t[1]},{key:a[0],value:a[1]})}))};var W=function(e){e=e.replace(/(?:official )?(?:lyric )?(?:video|audio)/gi,"").replace(/[ ([]?hq[)\] ]?/gi,"[-]").replace(/[ ([]?hd[)\] ]?/gi,"[-]").replace(/[AB] ?\d/,"").replace(/\( *\)/g,"").replace(/\[ *\]/g,"").trim();var t=null!==/.+ - .+ - .+/.exec(e),a=/([a-z\xe1\xe9\xed\xf3\xfa\xe0\xe8\xec\xf2\xf9\xe4\xeb\xef\xf6\xfc\xe2\xea\xee\xf4\xfb\xe7_0-9&.\/',\- ]+) - ([a-z\xe1\xe9\xed\xf3\xfa\xe0\xe8\xec\xf2\xf9\xe4\xeb\xef\xf6\xfc\xe2\xea\xee\xf4\xfb\xe7_0-9&.\/',\- ()]+)/i.exec(e);if(null===a||t){var n=/([a-z\xe1\xe9\xed\xf3\xfa\xe0\xe8\xec\xf2\xf9\xe4\xeb\xef\xf6\xfc\xe2\xea\xee\xf4\xfb\xe7_0-9&.\/',\- ]+) (?:'|\u2018)([a-z\xe1\xe9\xed\xf3\xfa\xe0\xe8\xec\xf2\xf9\xe4\xeb\xef\xf6\xfc\xe2\xea\xee\xf4\xfb\xe7_0-9&.\/',\- ()]+)(?:'|\u2019)/i.exec(e);return null!==n?{title:n[2].trim(),artist:n[1].trim()}:null}return{title:a[2].trim(),artist:a[1].trim()}};var B=function(){function e(){var t=this;Object(m.a)(this,e),this._userToken=null,this._userName=null,this._disableScrobblings=!1;var a=window.location.search.substr(1).split("&").map(function(e){return e.split("=")}).reduce(function(e,t){return e[t[0]]=t[1],e},{});if(window.localStorage.getItem("lastfm")){var n=JSON.parse(window.localStorage.getItem("lastfm")),i=n.userToken,o=n.userName,r=n.disableScrobblings;this._userToken=i,this._userName=o,this._disableScrobblings=r}else a.token&&this._makeRequest("get",{method:"auth.getSession",token:a.token}).then(function(e){t._userToken=e.session.key,t._userName=e.session.name,window.localStorage.setItem("lastfm",JSON.stringify({userToken:t._userToken,userName:t._userName,disableScrobblings:t._disableScrobblings}))})}return Object(g.a)(e,[{key:"startAuthentication",value:function(){var e=window.location.toString();window.location.assign("http://www.last.fm/api/auth/?api_key=".concat("201a5fdd42fd8cc5577fd0646b3e8ba7","&cb=").concat(encodeURIComponent(e)))}},{key:"deauthenticate",value:function(){window.localStorage.removeItem("lastfm"),window.location.reload()}},{key:"updateNowPlaying",value:function(e){return e.title&&e.artist&&!this._disableScrobblings?this._makeRequest("post",{track:e.title,artist:e.artist,duration:Math.trunc(e.duration),method:"track.updateNowPlaying"}):Promise.resolve({})}},{key:"scrobble",value:function(e){return e.title&&e.artist&&!this._disableScrobblings?this._makeRequest("post",{track:e.title,artist:e.artist,duration:Math.trunc(e.duration),timestamp:Math.trunc(+e.timestamp/1e3),method:"track.scrobble"}):Promise.resolve({})}},{key:"_makeRequest",value:function(t,a){!(arguments.length>2&&void 0!==arguments[2])||arguments[2];var n=new Map(a instanceof Map?a:Object.entries(a));n.set("api_key","201a5fdd42fd8cc5577fd0646b3e8ba7"),this._userToken&&n.set("sk",this._userToken),n.set("api_sig",this._signature(n)),n.set("format","json");var i=n.map(function(e,t){return"".concat(t,"=").concat(encodeURIComponent(e))}).join("&");if("get"===(t=t.toLowerCase()))return fetch("".concat(e.baseUrl,"?").concat(i)).then(function(e){return e.json()});if("post"===t){var o=new Headers;return o.append("Content-Type","application/x-www-form-urlencoded; charset=utf-8"),fetch(e.baseUrl,{method:"POST",body:i,headers:o}).then(function(e){return e.json()})}throw new Error("Unsupported method: "+t)}},{key:"_signature",value:function(e){var t=e.sort(function(e,t){return e.key.localeCompare(t.key)}).map(function(e,t){return t+e}).reduce(function(e,t){return e+t},"")+"8a5b2c73afdd9f1a585754d52449f0cd";return Y()(t)}},{key:"hasLoggedIn",get:function(){return this._userToken}},{key:"username",get:function(){return this._userName}},{key:"disableScrobblings",get:function(){return this._disableScrobblings},set:function(e){this._disableScrobblings=e,window.localStorage.setItem("lastfm",JSON.stringify(Object(l.a)({},JSON.parse(window.localStorage.getItem("lastfm")),{disableScrobblings:this._disableScrobblings})))}}]),e}();B.baseUrl="https://ws.audioscrobbler.com/2.0/";a(139);var z,H,J=function(e){function t(e){var a;return Object(m.a)(this,t),(a=Object(b.a)(this,Object(p.a)(t).call(this,e)))._testYoutubeVideoURL="https://www.youtube.com/watch?v=bM7SZ5SBzyY",a.state={youtubeVideoURL:"",qualityFromAudio:0,invalidURL:!1,youtubeAudioURL:"",youtubeVideoTitle:"",loading:!1,nightMode:!0,currentFormat:"",youtubeVideoID:"",showingQueue:!1,showingSearch:!1,youtubePlaylistID:"",playQueue:new T,isPlaying:!1,scrobblingState:"none"},a.audioRef=i.a.createRef(),a.lastfm=new B,window.xD=function(e){return a.lastfm.disableScrobblings=!!e},a.onPlaylistItemReorder=a.onPlaylistItemReorder.bind(Object(y.a)(Object(y.a)(a))),a.onPlaylistItemRemove=a.onPlaylistItemRemove.bind(Object(y.a)(Object(y.a)(a))),a.listenerTestButton=a.listenerTestButton.bind(Object(y.a)(Object(y.a)(a))),a.nightModeListener=a.nightModeListener.bind(Object(y.a)(Object(y.a)(a))),a.enqueueFromSeach=a.enqueueFromSeach.bind(Object(y.a)(Object(y.a)(a))),a.onWindowKeyUp=a.onWindowKeyUp.bind(Object(y.a)(Object(y.a)(a))),a.titleProgress=a.titleProgress.bind(Object(y.a)(Object(y.a)(a))),a.playFromSeach=a.playFromSeach.bind(Object(y.a)(Object(y.a)(a))),a.listenerForm=a.listenerForm.bind(Object(y.a)(Object(y.a)(a))),a.onSongError=a.onSongError.bind(Object(y.a)(Object(y.a)(a))),a.addToQueue=a.addToQueue.bind(Object(y.a)(Object(y.a)(a))),a.formatTime=a.formatTime.bind(Object(y.a)(Object(y.a)(a))),a.showQueue=a.showQueue.bind(Object(y.a)(Object(y.a)(a))),a.showSearch=a.showSearch.bind(Object(y.a)(Object(y.a)(a))),a.onSongEnd=a.onSongEnd.bind(Object(y.a)(Object(y.a)(a))),a.playSong=a.playSong.bind(Object(y.a)(Object(y.a)(a))),a.nextSong=a.nextSong.bind(Object(y.a)(Object(y.a)(a))),a.onPause=a.onPause.bind(Object(y.a)(Object(y.a)(a))),a.onPlay=a.onPlay.bind(Object(y.a)(Object(y.a)(a))),a.clear=a.clear.bind(Object(y.a)(Object(y.a)(a))),a}return Object(f.a)(t,e),Object(g.a)(t,[{key:"clear",value:function(){this.setState({playQueue:this.state.playQueue.emptyQueue()})}},{key:"addToQueue",value:function(){var e=Object(h.a)(d.a.mark(function e(){var t,a,n=this;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.youtubeVideoID){e.next=16;break}return this.setState({loading:!0}),e.prev=2,e.next=5,L(this.state.youtubeVideoID);case 5:t=e.sent,a=t.title,this.setState({loading:!1,playQueue:this.state.playQueue.add({id:this.state.youtubeVideoID,title:a})},function(){n.state.playQueue.values.length&&!n.state.youtubeAudioURL?(n.loadSong(n.state.playQueue.values[0].id),n.loadingToast.dismiss()):n.loadingToast.success("Enqueued",'"'.concat(a,'" was added to the queue'))}),e.next=14;break;case 10:e.prev=10,e.t0=e.catch(2),this.setState({loading:!1}),this.loadingToast.error(e.t0.message,e.t0.descriptiveMessage);case 14:e.next=17;break;case 16:this.state.youtubePlaylistID&&this.loadPlaylist();case 17:case"end":return e.stop()}},e,this,[[2,10]])}));return function(){return e.apply(this,arguments)}}()},{key:"playSong",value:function(){this.setState({playQueue:this.state.youtubeVideoID?this.state.playQueue.addFirst({id:this.state.youtubeVideoID,title:null}):this.state.playQueue}),this.state.youtubeVideoID?this.loadSong(this.state.youtubeVideoID,!0):this.state.youtubePlaylistID?this.loadPlaylist(!0):this.state.playQueue.values.length>0&&!this.state.youtubeVideoURL&&this.loadSong(this.state.playQueue.values[0].id)}},{key:"enqueueFromSeach",value:function(e){var t=this;"youtube#video"===e.id.kind?this.setState({youtubeVideoID:e.id.videoId},function(){return t.addToQueue()}):"youtube#playlist"===e.id.kind&&this.setState({youtubePlaylistID:e.id.playlistId},function(){return t.addToQueue()})}},{key:"playFromSeach",value:function(e){var t=this;"youtube#video"===e.id.kind?this.setState({youtubeVideoID:e.id.videoId},function(){return t.playSong()}):"youtube#playlist"===e.id.kind&&this.setState({youtubePlaylistID:e.id.playlistId},function(){return t.playSong()})}},{key:"loadSong",value:function(){var e=Object(h.a)(d.a.mark(function e(t){var a,n,o,r,s,l,c,u,m,g=this,b=arguments;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=b.length>1&&void 0!==b[1]&&b[1],this.setState({loading:!0}),e.prev=2,e.next=5,D(t);case 5:return n=e.sent,o=n.codec,r=n.bitrate,s=n.bps,l=n.id,this.setState({currentFormat:"".concat(o,"@~").concat(r||s,"kbps"),qualityFromAudio:l}),e.next=13,L(t,l);case 13:c=e.sent,u=c.url,m=c.title,this.setState({youtubeAudioURL:u,youtubeVideoTitle:m,loading:!1,scrobblingState:"none"},function(){w()("title").text("".concat(g.state.youtubeVideoTitle," - YouTube Audio")),a?g.audioRef.current.oncanplay=Object(h.a)(d.a.mark(function e(){return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,g.audioRef.current.play();case 3:g.loadingToast.dismiss(),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),k.toast.update(g.loadingToast._toast,{type:k.toast.TYPE.INFO,render:i.a.createElement(ee,{title:"Press play manually",light:!1,text:"Due to your browser configuration, we cannot press play for you. You can change your autoplay options in the browser's configuration."}),closeButton:null,closeOnClick:!0});case 9:g.audioRef.current.oncanplay=null,g.loadingToast=null;case 11:case"end":return e.stop()}},e,this,[[0,6]])})):(g.loadingToast.dismiss(),g.loadingToast=null)}),e.next=24;break;case 19:e.prev=19,e.t0=e.catch(2),this.setState({loading:!1,youtubeAudioURL:"",youtubeVideoTitle:""}),this.loadingToast.error(e.t0.message,e.t0.descriptiveMessage),this.loadingToast=null;case 24:case"end":return e.stop()}},e,this,[[2,19]])}));return function(t){return e.apply(this,arguments)}}()},{key:"loadPlaylist",value:function(){var e=Object(h.a)(d.a.mark(function e(t){var a,n,i;return d.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.setState({loading:!0}),e.prev=1,e.next=4,A(this.state.youtubePlaylistID,!0);case 4:n=e.sent,i={loading:!1,playQueue:(a=this.state.playQueue).add.apply(a,Object(c.a)(n))},!this.state.youtubeAudioURL&&i.playQueue.values.length>0&&(i.youtubeVideoID=i.playQueue.values[0].id,i.youtubeVideoTitle=i.playQueue.values[0].title,this.loadSong(i.playQueue.values[0].id,t)),this.setState(i),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(1),this.setState({loading:!1}),this.loadingToast.error(e.t0.message,e.t0.descriptiveMessage),this.loadingToast=null;case 15:case"end":return e.stop()}},e,this,[[1,10]])}));return function(t){return e.apply(this,arguments)}}()},{key:"listenerTestButton",value:function(e){e.preventDefault(),this.setState({youtubeVideoURL:this._testYoutubeVideoURL}),this.loadSong(this.getYoutubeVideoID(this._testYoutubeVideoURL),!0)}},{key:"listenerForm",value:function(e){var t=e.target.value.trim(),a={youtubeVideoURL:t},n=this.getYoutubeVideoID(t),i=this.getPlaylistID(t);null!==n?(a.invalidURL=!1,a.youtubeVideoID=n):null!==i?(a.invalidURL=!1,a.youtubePlaylistID=i):a.invalidURL=0!==t.length,this.setState(a),this.state.youtubeAudioURL||w()("title").text("YouTube Audio")}},{key:"getYoutubeVideoID",value:function(e){var a=/(?:(?:https?:\/\/)?(?:www\.)?youtube\.com\/watch\/?\?(.+))|(?:(?:https?:\/\/)?(?:www\.)?youtu\.be\/(.+))/.exec(e);if(null!==a){if(a[2])return a[2];if(a[1])return t.parseQuery(a[1]).v}else this.setState({loading:!1});return null}},{key:"getPlaylistID",value:function(e){var a=/playlist\?(.+)/g.exec(e);return null!==a?t.parseQuery(a[1]).list:null}},{key:"nightModeListener",value:function(e){e.preventDefault(),this.setState({nightMode:!this.state.nightMode})}},{key:"formatTime",value:function(e){var t=Math.round(e)%60,a=Math.floor(Math.round(e)/60);if(!this.audioRef.current||this.audioRef.current.duration<3600)return"".concat(a,":").concat(t<10?"0":"").concat(t);var n=Math.floor(a/60);return a%=60,"".concat(n,":").concat(a<10?"0":"").concat(a,":").concat(t<10?"0":"").concat(t)}},{key:"titleProgress",value:function(){var e=this,t=this.audioRef.current.currentTime,a=this.audioRef.current.duration,n=this.formatTime(t);if(w()("title").text("".concat(this.state.isPlaying?"\u25b6":"\u25ae\u25ae"," ").concat(n," - ").concat(this.state.youtubeVideoTitle," - YouTube Audio")),j.a.safari&&(a/=2),this.lastfm.hasLoggedIn)if("none"===this.state.scrobblingState){var i=W(this.state.youtubeVideoTitle);i?(this.setState({scrobblingState:null}),this.lastfm.updateNowPlaying(Object(l.a)({},i,{duration:a,timestamp:new Date})).then(function(){return e.setState({scrobblingState:"nowPlaying"})})):this.setState({scrobblingState:"nowPlaying"})}else if("nowPlaying"===this.state.scrobblingState&&t>=Math.min(a/2,240)){var o=W(this.state.youtubeVideoTitle);o?(this.setState({scrobblingState:null}),this.lastfm.scrobble(Object(l.a)({},o,{duration:a,timestamp:new Date})).then(function(){return e.setState({scrobblingState:"scrobbled"})})):this.setState({scrobblingState:"scrobbled"})}t>a&&t-a>1&&(this.audioRef.current.pause(),this.onSongEnd(null))}},{key:"onPlay",value:function(){this.setState({isPlaying:!0})}},{key:"onPause",value:function(){this.setState({isPlaying:!1})}},{key:"onSongEnd",value:function(){var e=this;this.setState({playQueue:this.state.playQueue.deleteFirst(),scrobblingState:"none"},function(){e.state.playQueue.values.length>0&&e.loadSong(e.state.playQueue.values[0].id,!0)})}},{key:"onSongError",value:function(e){switch(e.target.error.code){case e.target.error.MEDIA_ERR_NETWORK:k.toast.error(i.a.createElement(ee,{title:"There was a network error",text:"Could not load the song. Check your internet connection."}),{autoClose:!1});break;case e.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:var t=this.state,a=t.youtubeVideoID,n=t.qualityFromAudio;this.setState({youtubeAudioURL:"https://ytdl-audio-api.melchor9000.me/api/".concat(a,"/").concat(n,"/passthrough")});break;default:return}}},{key:"showQueue",value:function(e){e.preventDefault(),this.setState({showingQueue:!this.state.showingQueue,showingSearch:!!this.state.showingQueue&&this.state.showingSearch})}},{key:"showSearch",value:function(e){e.preventDefault(),this.setState({showingSearch:!this.state.showingSearch,showingQueue:!!this.state.showingSearch&&this.state.showingQueue})}},{key:"nextSong",value:function(e){e.preventDefault(),this.onSongEnd()}},{key:"onPlaylistItemReorder",value:function(e,t){var a=this.state.playQueue.reorder(e,t);this.setState({playQueue:a})}},{key:"onPlaylistItemRemove",value:function(e){var t=this.state.playQueue.delete(e);this.setState({playQueue:t})}},{key:"onWindowKeyUp",value:function(e){"Space"===e.code&&"videoURL"!==e.target.getAttribute("id")&&this.audioRef.current&&(e.preventDefault(),e.stopPropagation(),this.audioRef.current.paused?this.audioRef.current.play().catch():this.audioRef.current.pause())}},{key:"componentDidMount",value:function(){var e=this;window.addEventListener("keyup",this.onWindowKeyUp),window.addEventListener("resize",function(){return e.forceUpdate()}),"majorcadevs.github.io"===window.location.hostname&&k.toast.info(i.a.createElement("p",null,"We've change the location to",i.a.createElement("a",{href:"https://youtubeAudio.majorcadevs.com"},"https://youtubeAudio.majorcadevs.com"),".",i.a.createElement("small",null,"We'll redirect you to the new location when this notification is closed :)")),{onClose:function(){return window.location.assign("https://youtubeAudio.majorcadevs.com")},autoClose:1e4})}},{key:"componentDidUpdate",value:function(e,t){!t.loading&&this.state.loading&&(this.loadingToast=new ne),t.isPlaying!==this.state.isPlaying&&w()("title").text("".concat(this.state.isPlaying?"\u25b6":"\u25ae\u25ae","\n                ").concat(this.formatTime(this.audioRef.current.currentTime)," - ").concat(this.state.youtubeVideoTitle," - YouTube Audio")),!t.nightMode&&this.state.nightMode?w()("body").addClass("AppDark").removeClass("AppLight"):t.nightMode&&!this.state.nightMode&&w()("body").removeClass("AppDark").addClass("AppLight")}},{key:"render",value:function(){var e=this.state,t=e.youtubeVideoURL,a=e.invalidURL,n=e.youtubeVideoTitle,o=e.youtubeAudioURL,r=e.loading,s=e.nightMode,l=e.showingQueue,c=e.currentFormat,u=e.playQueue,d=e.showingSearch;return i.a.createElement("div",{id:"AppContainer"},i.a.createElement($,{nightMode:s,nightModeListener:this.nightModeListener,lastfm:this.lastfm}),i.a.createElement("div",{className:"container-fluid"},i.a.createElement(k.ToastContainer,{pauseOnHover:!1}),i.a.createElement("p",{className:"greyText",id:"greyText"},"Enjoy the audio from the youtube videos!"),i.a.createElement("div",{className:"d-flex row justify-content-center align-items-center",id:"audioQuery"},i.a.createElement("div",{className:"col-md-6 col-sm-12"},i.a.createElement("div",{className:"input-group",id:"input"},i.a.createElement("div",{className:"input-group-prepend"},i.a.createElement(K,{nightMode:s,id:"test",name:"test",value:"TEST",onClick:this.listenerTestButton,disabled:r})),i.a.createElement("input",{type:"text",className:"form-control ".concat(a?"is-invalid":""),id:"videoURL",name:"videoURL",onChange:this.listenerForm,value:t,placeholder:"insert here your youtube video url...",disabled:r})),i.a.createElement("div",{className:"row justify-content-center"},i.a.createElement("div",{className:"btn-group mt-3"},i.a.createElement(K,{nightMode:s,name:"Play Song",value:"Play Now!",onClick:this.playSong,disabled:(r||a||0===t.length)&&u.values.length<1}),i.a.createElement(K,{nightMode:s,name:"Add to Queue",value:"Enqueue",onClick:this.addToQueue,disabled:r||a||0===t.length}),i.a.createElement(K,{nightMode:s,name:"Clear queueue",value:"Clear Queue",onClick:this.clear,disabled:r||u.values.length<2}),i.a.createElement(K,{nightMode:s,name:"Next song",value:"Next Song",onClick:this.nextSong,disabled:r||u.values.length<2}))),i.a.createElement(Z,{title:n,currentFormat:c}),this.state.youtubeAudioURL?i.a.createElement("audio",{id:"player",className:"player",controls:!0,src:o,onError:this.onSongError,onTimeUpdate:this.titleProgress,ref:this.audioRef,onEnded:this.onSongEnd,onPlay:this.onPlay,onPause:this.onPause}):null)),i.a.createElement(_,{showing:l,playQueue:this.state.playQueue,onPlaylistItemReorder:this.onPlaylistItemReorder,onPlaylistItemRemove:this.onPlaylistItemRemove}),i.a.createElement(V,{showing:d,onPlayClicked:this.playFromSeach,onEnqueueClicked:this.enqueueFromSeach}),i.a.createElement(te,{onClick:this.showQueue,showingQueue:l,nightMode:s,left:l||d}),i.a.createElement(ae,{onClick:this.showSearch,showingSearch:d,nightMode:s,left:l||d})),i.a.createElement(X,null))}}],[{key:"parseQuery",value:function(e){return e.split("&").map(function(e){return e.split("=")}).reduce(function(e,t){return Object(l.a)({},e,Object(s.a)({},t[0],t[1]))},{})}}]),t}(n.Component),K=function(e){var t=Object(l.a)({},e);return delete t.nightMode,i.a.createElement("input",Object.assign({type:"button",className:"btn btn-outline-".concat(e.nightMode?"light":"dark")},t))},G=function(){return i.a.createElement("div",{className:"row justify-content-center"},i.a.createElement("div",{className:"title loading",id:"stateText"},"Loading..."),i.a.createElement("div",{className:"loader"}))},Z=(z="title",H=function(e){var t=e.title,a=e.currentFormat;return i.a.createElement("div",{className:"title",id:"stateText"},i.a.createElement("div",{id:"NowPlaying"},"Now Playing: (",a,")"),i.a.createElement("div",{id:"title",className:"text-center"}," ",t," "))},function(e){return e[z]?H(e):null}),$=function(e){var t=e.nightMode,a=e.nightModeListener,n=e.lastfm;return i.a.createElement("header",{className:"AppHeader",id:"AppHeader"},i.a.createElement("h1",{className:"App-title"},"YouTube Audio Player"),i.a.createElement("button",{className:"btn btn-sm btn-outline-light float-right onoffmode",id:"changeSkinButton",onClick:a},t?i.a.createElement("i",{className:"material-icons"},"wb_sunny"):i.a.createElement("i",{className:"material-icons"},"brightness_2")),i.a.createElement("button",{className:"btn btn-sm btn-outline-light float-right lastfm",onClick:function(){return n.hasLoggedIn?n.deauthenticate():n.startAuthentication()}},i.a.createElement("img",{src:"https://www.last.fm/static/images/footer_logo@2x.49ca51948b0a.png",width:24,alt:n.username}),n.hasLoggedIn&&i.a.createElement("i",{className:"material-icons",style:{position:"absolute",top:0,left:0,fontSize:34,marginLeft:1,color:"rgb(255, 180, 180)"}},"close")))},X=function(){return i.a.createElement("footer",{className:"AppFooter footer align-items-center",id:"AppFooter"},i.a.createElement("div",{id:"FooterContent"},i.a.createElement("a",{href:"https://github.com/MajorcaDevs/youtubeAudio",target:"_blank",rel:"noopener noreferrer"},i.a.createElement("img",{alt:"GitHub",src:P.a,id:"githubLogo",className:"mr-1"}),"\xa0Made by ",i.a.createElement("b",null,"MajorcaDevs")," with ",i.a.createElement("b",null,"<3"))))},ee=function(e){var t=e.title,a=e.text,n=e.light;return i.a.createElement("div",null,i.a.createElement("p",{className:"lead"},t),i.a.createElement("p",{className:n?"text-light":"text-muted"},i.a.createElement("small",null,a)))},te=function(e){var t=e.showingQueue,a=e.nightMode,n=e.onClick,o=e.left;return i.a.createElement(E.a,{from:{right:15},to:{right:o?Math.min(15-_._right,document.body.clientWidth-45):15}},function(e){return i.a.createElement("button",{id:"playQueue",style:e,className:"btn ".concat(t?"right":"left"," btn-outline-").concat(a?"light":"dark"),onClick:n},i.a.createElement("div",{id:"arrow",className:"".concat(t?"right":"left")}))})},ae=function(e){var t=e.showingSearch,a=e.nightMode,n=e.onClick,o=e.left;return i.a.createElement(E.a,{from:{right:15},to:{right:o?Math.min(15-V._right,document.body.clientWidth-45):15}},function(e){return i.a.createElement("button",{id:"searchPanelButton",style:e,className:"btn ".concat(t?"right":"left"," btn-outline-").concat(a?"light":"dark"),onClick:n},i.a.createElement("i",{className:"material-icons"},"search"))})},ne=function(){function e(){Object(m.a)(this,e),this._toast=Object(k.toast)(i.a.createElement(G,null),{autoClose:!1,closeOnClick:!1,closeButton:!1})}return Object(g.a)(e,[{key:"success",value:function(e,t){k.toast.update(this._toast,{type:k.toast.TYPE.DEFAULT,render:i.a.createElement(ee,{title:e,light:!1,text:t}),autoClose:4e3,closeButton:null,closeOnClick:!0})}},{key:"error",value:function(e,t){k.toast.update(this._toast,{render:i.a.createElement(ee,{title:"Video not found",light:!0,text:"Check that the video URL exists or is complete."}),type:k.toast.TYPE.ERROR,closeButton:null,closeOnClick:!0})}},{key:"dismiss",value:function(){k.toast.dismiss(this._toast)}}]),e}(),ie=J,oe=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function re(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available; please refresh."),k.toast.info("There's and update of the app. Refresh the page to apply it.",{autoClose:!1})):(console.log("Content is cached for offline use."),k.toast.info("[FYI] The web is cached to speed up the page.")))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}r.a.render(i.a.createElement(ie,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("/youtubeAudio",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("/youtubeAudio","/service-worker.js");oe?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):re(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode."),k.toast.error("You are not connected to internet. The web won't work without internet.",{autoClose:!1})})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):re(e)})}}()},63:function(e,t,a){e.exports=a.p+"static/media/github.960ee6c3.svg"},70:function(e,t,a){e.exports=a(141)},93:function(e,t,a){},96:function(e,t,a){}},[[70,2,1]]]);
//# sourceMappingURL=main.5e26b7cf.chunk.js.map